---
layout: question
title:  如何清理不在package.json中的软件包的node_modules文件夹？
date:   2020-03-18T09:55:02.000Z
description: 假设我安装了项目包，npm install其中包含package.json要安装的模块。一段时间后，我发现不需要某些特定的模块，并从中删除了对它的依赖pa...
img: 
author: 斯丁A
category: question
answer: 11
tags: node.js Node.js
topic: Node.js
---
<div class="article-root">
  <div class="article">
    {% include articleTitle.html info=page %}
    {% raw %}
    <div class="article-content"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设我安装了项目包，</font></font><code>npm install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中包含</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要安装的模块。</font><font style="vertical-align: inherit;">一段时间后，我发现不需要某些特定的模块，并从中删除了对它的依赖</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后我从中删除了一些其他模块，</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为不再需要它们，而</font><font style="vertical-align: inherit;">其他模块</font><font style="vertical-align: inherit;">则被替换。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，我要清理</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件夹，以便只有其中列出的模块可以</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呆在那儿，其余的必须去掉，例如</font></font><code>npm clean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我知道我可以手动删除它们，但希望为此可以使用糖功能。</font></font></p></div>
    {% endraw %}
  </div>

  <div class="discuss-wrapper">
    {% include discussTitle.html info=page %}
    {% raw %}
    <div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">SamTony猿</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除/编辑package-lock.json中不需要的程序包（程序包名称将写在依赖关系和devDependencies下），然后</font></font></p>

<p><code>npm install</code></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">JinJin逆天</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下命令代替npm install</font></font></p>

<pre><code>npm ci
</code></pre></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">逆天小胖Mandy</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于Windows用户，此处列出的删除此文件夹的替代解决方案：</font><a href="http://ask.osify.com/qa/567" rel="nofollow"><font style="vertical-align: inherit;">http</font></a><font style="vertical-align: inherit;"> : </font></font><a href="http://ask.osify.com/qa/567" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//ask.osify.com/qa/567</font></font></a></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中，有一个免费工具：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Long Path Fixer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以尝试：</font><a href="http://corz.org/windows/software/accessories/Long-Path-Fixer-for-Windows.php" rel="nofollow"><font style="vertical-align: inherit;">http</font></a><font style="vertical-align: inherit;"> : </font></font><a href="http://corz.org/windows/software/accessories/Long-Path-Fixer-for-Windows.php" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//corz.org/windows/software/accessories/Long-Path-Fixer-for-Windows.php</font></font></a></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">EvaEva斯丁</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我在package.json中添加了几行：</font></font></p>

<pre><code>"scripts": {<font></font>
  ...<font></font>
  "clean": "rmdir /s /q node_modules",<font></font>
  "reinstall": "npm run clean &amp;&amp; npm install",<font></font>
  "rebuild": "npm run clean &amp;&amp; npm install &amp;&amp; rmdir /s /q dist &amp;&amp; npm run build --prod",<font></font>
  ...<font></font>
}<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果只想</font></font><code>clean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用，可以使用</font></font><code>rimraf node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>rm -rf node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作正常</font></font></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">番长Pro</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从6.5.0版本开始，npm支持命令</font></font><code>clean-install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来强制刷新所有软件包</font></font></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">达蒙斯丁</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您尝试过npm修剪吗？</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它应该卸载软件包文件中未列出的所有内容</font></font></p>

<p><a href="https://npmjs.org/doc/cli/npm-prune.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://npmjs.org/doc/cli/npm-prune.html</font></font></a></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">启人Green</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我想你在找 </font></font><code>npm prune</code></p>

<blockquote>
  <p><code>npm prune [&lt;name&gt; [&lt;name ...]]</code></p>
  
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此命令删除“外部”软件包。</font><font style="vertical-align: inherit;">如果提供了软件包名称，则仅删除与提供的名称之一匹配的软件包。</font></font></p>
  
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无关软件包是未在父软件包的依赖项列表中列出的软件包。</font></font></p>
</blockquote>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅文档：</font><a href="https://docs.npmjs.com/cli/prune"><font style="vertical-align: inherit;">https</font></a><font style="vertical-align: inherit;"> : </font></font><a href="https://docs.npmjs.com/cli/prune"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//docs.npmjs.com/cli/prune</font></font></a></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">小胖蛋蛋前端</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简单就跑</font></font></p>

<pre><code>rm -r node_modules
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实际上，您可以使用此方法删除任何文件夹。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">像</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rm -r AnyFolderWhichIsNotDeletableFromShiftDeleteOrDelete</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需打开</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gitbash</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移动到文件夹的根目录并运行此命令</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">希望这会有所帮助。</font></font></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">斯丁理查德</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以删除node_modules /文件夹，然后从package.json重新安装依赖项。</font></font></p>

<pre><code>rm -rf node_modules/<font></font>
npm install<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将清除当前文件夹中所有已安装的软件包，并且仅安装package.json中的依赖项。</font><font style="vertical-align: inherit;">如果先前已安装依赖项，则npm将尝试使用缓存的版本，避免再次下载依赖项。</font></font></p></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">GilJinJin</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首次在全球范围内安装rimraf</font></font></p>

<pre><code>npm install rimraf -g
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用cmd转到您的node_modules文件夹所在的路径，并在以下命令中应用</font></font></p>

<pre><code>rimraf node_modules
</code></pre></div>
        </div>
        
      </div><div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">乐米亚</span>
            <span class="discuss-time">2020.03.18</span>
          </div>
          <div class="discuss-comment"><blockquote>
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于文件夹嵌套，Windows无法删除该文件夹，因为其名称太长。</font><font style="vertical-align: inherit;">要解决此问题，请安装RimRaf：</font></font></p>
</blockquote>

<pre><code>npm install rimraf -g<font></font>
<font></font>
rimraf node_modules<font></font>
</code></pre></div>
        </div>
        
      </div>
    {% endraw %}
  </div>
<div>
