---
layout: question
title:  如何旋转数据框
date:   2020-05-28T07:07:34.000Z
description: 什么是支点？我如何枢纽？这是支点吗？长格式到宽格式？我已经看到很多有关数据透视表的问题。即使他们不知道他们在询问数据透视表，通常也是如此。几...
img: 
author: 神奇神奇Near
category: question
answer: 0
tags: Python
topic: Python
---
<div class="article-root">
  <div class="article">
    {% include articleTitle.html info=page %}
    {% raw %}
    <div class="article-content"><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么是支点？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我如何枢纽？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是支点吗？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长格式到宽格式？</font></font></li>
</ul>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我已经看到很多有关数据透视表的问题。</font><font style="vertical-align: inherit;">即使他们不知道他们在询问数据透视表，通常也是如此。</font><font style="vertical-align: inherit;">几乎不可能写出涵盖枢纽各个方面的规范问答。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...但是我要去尝试一下。</font></font></p>

<hr>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现有问题和答案的问题在于，问题通常集中在OP难以推广的细微差别上，以便使用许多现有的良好答案。</font><font style="vertical-align: inherit;">但是，没有一个答案试图给出全面的解释（因为这是一项艰巨的任务）</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从我的</font><a href="https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe&amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe" rel="noreferrer"><strong><font style="vertical-align: inherit;">Google搜索中</font></strong></a><font style="vertical-align: inherit;">查找一些示例</font></font><a href="https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe&amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe" rel="noreferrer"><strong><font style="vertical-align: inherit;"></font></strong></a></p>

<ol>
<li><a href="https://stackoverflow.com/q/28337117/2336654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何在Pandas中透视数据框？</font></font></a>

<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好问题和答案。</font><font style="vertical-align: inherit;">但是答案只回答了很少的具体问题。</font></font></li>
</ul></li>
<li><a href="https://stackoverflow.com/q/42708193/2336654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas数据透视表到数据框</font></font></a>

<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此问题中，OP与枢轴的输出有关。</font><font style="vertical-align: inherit;">即列的外观。</font><font style="vertical-align: inherit;">OP希望它看起来像R。这对Pandas用户不是很有帮助。</font></font></li>
</ul></li>
<li><a href="https://stackoverflow.com/q/11400181/2336654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">旋转数据框的Pandas，重复的行</font></font></a>

<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另一个不错的问题，但答案集中在一种方法上，即 </font></font><code>pd.DataFrame.pivot</code></li>
</ul></li>
</ol>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，每当有人搜索时，</font></font><code>pivot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他们都会得到零星的结果，这些结果可能不会回答他们的特定问题。</font></font></p>

<hr>

<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设定</font></font></h1>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能会注意到，我显眼地命名了我的列和相关的列值，以与我将在下面的答案中介绍的方式相对应。 </font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np
</span><span class="kwd">import</span><span class="pln"> pandas </span><span class="kwd">as</span><span class="pln"> pd
</span><span class="kwd">from</span><span class="pln"> numpy</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="pln">defchararray </span><span class="kwd">import</span><span class="pln"> add

np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">seed</span><span class="pun">([</span><span class="lit">3</span><span class="pun">,</span><span class="lit">1415</span><span class="pun">])</span><span class="pln">
n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">20</span><span class="pln">

cols </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">array</span><span class="pun">([</span><span class="str">'key'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'row'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'item'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'col'</span><span class="pun">])</span><span class="pln">
arr1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">randint</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> size</span><span class="pun">=(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">))</span><span class="pln"> </span><span class="pun">//</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]).</span><span class="pln">astype</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)</span><span class="pln">

df </span><span class="pun">=</span><span class="pln"> pd</span><span class="pun">.</span><span class="typ">DataFrame</span><span class="pun">(</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">cols</span><span class="pun">,</span><span class="pln"> arr1</span><span class="pun">),</span><span class="pln"> columns</span><span class="pun">=</span><span class="pln">cols
</span><span class="pun">).</span><span class="pln">join</span><span class="pun">(</span><span class="pln">
    pd</span><span class="pun">.</span><span class="typ">DataFrame</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">rand</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">round</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)).</span><span class="pln">add_prefix</span><span class="pun">(</span><span class="str">'val'</span><span class="pun">)</span><span class="pln">
</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span><span class="pln">

     key   row   item   col  val0  val1
</span><span class="lit">0</span><span class="pln">   key0  row3  item1  col3  </span><span class="lit">0.81</span><span class="pln">  </span><span class="lit">0.04</span><span class="pln">
</span><span class="lit">1</span><span class="pln">   key1  row2  item1  col2  </span><span class="lit">0.44</span><span class="pln">  </span><span class="lit">0.07</span><span class="pln">
</span><span class="lit">2</span><span class="pln">   key1  row0  item1  col0  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.01</span><span class="pln">
</span><span class="lit">3</span><span class="pln">   key0  row4  item0  col2  </span><span class="lit">0.15</span><span class="pln">  </span><span class="lit">0.59</span><span class="pln">
</span><span class="lit">4</span><span class="pln">   key1  row0  item2  col1  </span><span class="lit">0.81</span><span class="pln">  </span><span class="lit">0.64</span><span class="pln">
</span><span class="lit">5</span><span class="pln">   key1  row2  item2  col4  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.88</span><span class="pln">
</span><span class="lit">6</span><span class="pln">   key2  row4  item1  col3  </span><span class="lit">0.88</span><span class="pln">  </span><span class="lit">0.39</span><span class="pln">
</span><span class="lit">7</span><span class="pln">   key1  row4  item1  col1  </span><span class="lit">0.10</span><span class="pln">  </span><span class="lit">0.07</span><span class="pln">
</span><span class="lit">8</span><span class="pln">   key1  row0  item2  col4  </span><span class="lit">0.65</span><span class="pln">  </span><span class="lit">0.02</span><span class="pln">
</span><span class="lit">9</span><span class="pln">   key1  row2  item0  col2  </span><span class="lit">0.35</span><span class="pln">  </span><span class="lit">0.61</span><span class="pln">
</span><span class="lit">10</span><span class="pln">  key2  row0  item2  col1  </span><span class="lit">0.40</span><span class="pln">  </span><span class="lit">0.85</span><span class="pln">
</span><span class="lit">11</span><span class="pln">  key2  row4  item1  col2  </span><span class="lit">0.64</span><span class="pln">  </span><span class="lit">0.25</span><span class="pln">
</span><span class="lit">12</span><span class="pln">  key0  row2  item2  col3  </span><span class="lit">0.50</span><span class="pln">  </span><span class="lit">0.44</span><span class="pln">
</span><span class="lit">13</span><span class="pln">  key0  row4  item1  col4  </span><span class="lit">0.24</span><span class="pln">  </span><span class="lit">0.46</span><span class="pln">
</span><span class="lit">14</span><span class="pln">  key1  row3  item2  col3  </span><span class="lit">0.28</span><span class="pln">  </span><span class="lit">0.11</span><span class="pln">
</span><span class="lit">15</span><span class="pln">  key0  row3  item1  col1  </span><span class="lit">0.31</span><span class="pln">  </span><span class="lit">0.23</span><span class="pln">
</span><span class="lit">16</span><span class="pln">  key0  row0  item2  col3  </span><span class="lit">0.86</span><span class="pln">  </span><span class="lit">0.01</span><span class="pln">
</span><span class="lit">17</span><span class="pln">  key0  row4  item0  col3  </span><span class="lit">0.64</span><span class="pln">  </span><span class="lit">0.21</span><span class="pln">
</span><span class="lit">18</span><span class="pln">  key2  row2  item2  col0  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.45</span><span class="pln">
</span><span class="lit">19</span><span class="pln">  key0  row2  item0  col4  </span><span class="lit">0.37</span><span class="pln">  </span><span class="lit">0.70</span></code></pre>

<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">问题</font></font></h3>

<ol>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我为什么得到 </font></font><code>ValueError: Index contains duplicate entries, cannot reshape</code></p></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何旋转</font></font><code>df</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以使</font></font><code>col</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值成为列，</font></font><code>row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值成为索引，值的均值</font></font><code>val0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">col   col0   col1   col2   col3  col4
row                                  
row0  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.605</span><span class="pln">    </span><span class="typ">NaN</span><span class="pln">  </span><span class="lit">0.860</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">
row2  </span><span class="lit">0.13</span><span class="pln">    </span><span class="typ">NaN</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.500</span><span class="pln">  </span><span class="lit">0.25</span><span class="pln">
row3   </span><span class="typ">NaN</span><span class="pln">  </span><span class="lit">0.310</span><span class="pln">    </span><span class="typ">NaN</span><span class="pln">  </span><span class="lit">0.545</span><span class="pln">   </span><span class="typ">NaN</span><span class="pln">
row4   </span><span class="typ">NaN</span><span class="pln">  </span><span class="lit">0.100</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.760</span><span class="pln">  </span><span class="lit">0.24</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何旋转</font></font><code>df</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以使</font></font><code>col</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是列，</font></font><code>row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是索引，值的均值</font></font><code>val0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是和缺少值是</font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">col   col0   col1   col2   col3  col4
row                                  
row0  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.605</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.860</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">
row2  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.500</span><span class="pln">  </span><span class="lit">0.25</span><span class="pln">
row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.310</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.545</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
row4  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.100</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.760</span><span class="pln">  </span><span class="lit">0.24</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以得到比其他的东西</font></font><code>mean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如可能</font></font><code>sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">col   col0  col1  col2  col3  col4
row                               
row0  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">1.21</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.86</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">
row2  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.79</span><span class="pln">  </span><span class="lit">0.50</span><span class="pln">  </span><span class="lit">0.50</span><span class="pln">
row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.31</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">1.09</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
row4  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.10</span><span class="pln">  </span><span class="lit">0.79</span><span class="pln">  </span><span class="lit">1.52</span><span class="pln">  </span><span class="lit">0.24</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以一次做多个聚合吗？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">       sum                          mean                           
col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4
row                                                                
row0  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">1.21</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.86</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.605</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.860</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">
row2  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.79</span><span class="pln">  </span><span class="lit">0.50</span><span class="pln">  </span><span class="lit">0.50</span><span class="pln">  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.500</span><span class="pln">  </span><span class="lit">0.25</span><span class="pln">
row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.31</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">1.09</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.310</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.545</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
row4  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.10</span><span class="pln">  </span><span class="lit">0.79</span><span class="pln">  </span><span class="lit">1.52</span><span class="pln">  </span><span class="lit">0.24</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.100</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.760</span><span class="pln">  </span><span class="lit">0.24</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以汇总多个值列吗？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">      val0                             val1                          
col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
row                                                                  
row0  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.605</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.860</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">  </span><span class="lit">0.01</span><span class="pln">  </span><span class="lit">0.745</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.010</span><span class="pln">  </span><span class="lit">0.02</span><span class="pln">
row2  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.500</span><span class="pln">  </span><span class="lit">0.25</span><span class="pln">  </span><span class="lit">0.45</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.34</span><span class="pln">  </span><span class="lit">0.440</span><span class="pln">  </span><span class="lit">0.79</span><span class="pln">
row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.310</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.545</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.230</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.075</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
row4  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.100</span><span class="pln">  </span><span class="lit">0.395</span><span class="pln">  </span><span class="lit">0.760</span><span class="pln">  </span><span class="lit">0.24</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.070</span><span class="pln">  </span><span class="lit">0.42</span><span class="pln">  </span><span class="lit">0.300</span><span class="pln">  </span><span class="lit">0.46</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以细分为多列吗？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">item item0             item1                         item2                   
col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
row                                                                          
row0  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.605</span><span class="pln">  </span><span class="lit">0.86</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">
row2  </span><span class="lit">0.35</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.37</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.44</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.50</span><span class="pln">  </span><span class="lit">0.13</span><span class="pln">
row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.31</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.81</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.28</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
row4  </span><span class="lit">0.15</span><span class="pln">  </span><span class="lit">0.64</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.10</span><span class="pln">  </span><span class="lit">0.64</span><span class="pln">  </span><span class="lit">0.88</span><span class="pln">  </span><span class="lit">0.24</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.000</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要么 </font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">item      item0             item1                         item2                  
col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
key  row                                                                         
key0 row0  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.86</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
     row2  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.37</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.50</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
     row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.31</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.81</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
     row4  </span><span class="lit">0.15</span><span class="pln">  </span><span class="lit">0.64</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.24</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
key1 row0  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.77</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.81</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.65</span><span class="pln">
     row2  </span><span class="lit">0.35</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.44</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.13</span><span class="pln">
     row3  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.28</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
     row4  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.10</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
key2 row0  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.40</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
     row2  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.13</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">
     row4  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.64</span><span class="pln">  </span><span class="lit">0.88</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span><span class="pln">  </span><span class="lit">0.00</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以汇总列和行一起出现的频率，又称为“交叉表”吗？</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">col   col0  col1  col2  col3  col4
row                               
row0     </span><span class="lit">1</span><span class="pln">     </span><span class="lit">2</span><span class="pln">     </span><span class="lit">0</span><span class="pln">     </span><span class="lit">1</span><span class="pln">     </span><span class="lit">1</span><span class="pln">
row2     </span><span class="lit">1</span><span class="pln">     </span><span class="lit">0</span><span class="pln">     </span><span class="lit">2</span><span class="pln">     </span><span class="lit">1</span><span class="pln">     </span><span class="lit">2</span><span class="pln">
row3     </span><span class="lit">0</span><span class="pln">     </span><span class="lit">1</span><span class="pln">     </span><span class="lit">0</span><span class="pln">     </span><span class="lit">2</span><span class="pln">     </span><span class="lit">0</span><span class="pln">
row4     </span><span class="lit">0</span><span class="pln">     </span><span class="lit">1</span><span class="pln">     </span><span class="lit">2</span><span class="pln">     </span><span class="lit">2</span><span class="pln">     </span><span class="lit">1</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何通过仅旋转两列将DataFrame从长转换为宽？</font><font style="vertical-align: inherit;">鉴于</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">seed</span><span class="pun">([</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1415</span><span class="pun">])</span><span class="pln">
df2 </span><span class="pun">=</span><span class="pln"> pd</span><span class="pun">.</span><span class="typ">DataFrame</span><span class="pun">({</span><span class="str">'A'</span><span class="pun">:</span><span class="pln"> list</span><span class="pun">(</span><span class="str">'aaaabbbc'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'B'</span><span class="pun">:</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">choice</span><span class="pun">(</span><span class="lit">15</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)})</span><span class="pln">        
df2        
   A   B
</span><span class="lit">0</span><span class="pln">  a   </span><span class="lit">0</span><span class="pln">
</span><span class="lit">1</span><span class="pln">  a  </span><span class="lit">11</span><span class="pln">
</span><span class="lit">2</span><span class="pln">  a   </span><span class="lit">2</span><span class="pln">
</span><span class="lit">3</span><span class="pln">  a  </span><span class="lit">11</span><span class="pln">
</span><span class="lit">4</span><span class="pln">  b  </span><span class="lit">10</span><span class="pln">
</span><span class="lit">5</span><span class="pln">  b  </span><span class="lit">10</span><span class="pln">
</span><span class="lit">6</span><span class="pln">  b  </span><span class="lit">14</span><span class="pln">
</span><span class="lit">7</span><span class="pln">  c   </span><span class="lit">7</span></code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预期应该看起来像</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">      a     b    c
</span><span class="lit">0</span><span class="pln">   </span><span class="lit">0.0</span><span class="pln">  </span><span class="lit">10.0</span><span class="pln">  </span><span class="lit">7.0</span><span class="pln">
</span><span class="lit">1</span><span class="pln">  </span><span class="lit">11.0</span><span class="pln">  </span><span class="lit">10.0</span><span class="pln">  </span><span class="typ">NaN</span><span class="pln">
</span><span class="lit">2</span><span class="pln">   </span><span class="lit">2.0</span><span class="pln">  </span><span class="lit">14.0</span><span class="pln">  </span><span class="typ">NaN</span><span class="pln">
</span><span class="lit">3</span><span class="pln">  </span><span class="lit">11.0</span><span class="pln">   </span><span class="typ">NaN</span><span class="pln">  </span><span class="typ">NaN</span></code></pre></li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我如何将多重索引展平为单索引 </font></font><code>pivot</code></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">   </span><span class="lit">1</span><span class="pln">  </span><span class="lit">2</span><span class="pln">   
   </span><span class="lit">1</span><span class="pln">  </span><span class="lit">1</span><span class="pln">  </span><span class="lit">2</span><span class="pln">        
a  </span><span class="lit">2</span><span class="pln">  </span><span class="lit">1</span><span class="pln">  </span><span class="lit">1</span><span class="pln">
b  </span><span class="lit">2</span><span class="pln">  </span><span class="lit">1</span><span class="pln">  </span><span class="lit">0</span><span class="pln">
c  </span><span class="lit">1</span><span class="pln">  </span><span class="lit">0</span><span class="pln">  </span><span class="lit">0</span></code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至 </font></font></p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">   </span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln">  </span><span class="lit">2</span><span class="pun">|</span><span class="lit">1</span><span class="pln">  </span><span class="lit">2</span><span class="pun">|</span><span class="lit">2</span><span class="pln">               
a    </span><span class="lit">2</span><span class="pln">    </span><span class="lit">1</span><span class="pln">    </span><span class="lit">1</span><span class="pln">
b    </span><span class="lit">2</span><span class="pln">    </span><span class="lit">1</span><span class="pln">    </span><span class="lit">0</span><span class="pln">
c    </span><span class="lit">1</span><span class="pln">    </span><span class="lit">0</span><span class="pln">    </span><span class="lit">0</span></code></pre></li>
</ol></div>
    {% endraw %}
  </div>

  <div class="discuss-wrapper">
    {% include discussTitle.html info=page %}
    {% raw %}
    
    {% endraw %}
  </div>
<div>
