---
layout: question
title:  nuxt start要求存在node_modules才能运行
date:   2020-03-24T07:58:59.000Z
description: 我有一个nuxt-community/starter-template最少添加的项目。我package.json看起来像这样{  // ...  ...
img: 
author: 猴子村村
category: question
answer: 1
tags: 的node.js Vue.js
topic: Vue.js
---
<div class="article-root">
  <div class="article">
    {% include articleTitle.html info=page %}
    {% raw %}
    <div class="article-content"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我有一个</font></font><code>nuxt-community/starter-template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最少添加</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">项目。</font><font style="vertical-align: inherit;">我</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看起来像这样</font></font></p>

<pre><code>{<font></font>
  // ...<font></font>
  "scripts": {<font></font>
    "dev": "nuxt",<font></font>
    "build": "nuxt build",<font></font>
    "docker-image": "nuxt build &amp;&amp; docker build -t unijobs-www-temp .",<font></font>
    "start": "nuxt start",<font></font>
    "generate": "NODE_ENV=production nuxt generate",<font></font>
    "lint": "eslint --ext .js,.vue --ignore-path .gitignore .",<font></font>
    "precommit": "npm run lint"<font></font>
  },<font></font>
  "dependencies": {<font></font>
    "@fortawesome/fontawesome": "^1.1.8",<font></font>
    "@fortawesome/fontawesome-free-brands": "^5.0.13",<font></font>
    "@fortawesome/fontawesome-free-regular": "^5.0.13",<font></font>
    "@fortawesome/fontawesome-free-solid": "^5.0.13",<font></font>
    "@fortawesome/vue-fontawesome": "0.0.22",<font></font>
    "nuxt": "^1.0.0",<font></font>
    "nuxt-fontawesome": "^0.2.0",<font></font>
    "node-sass": "^4.9.0",<font></font>
    "sass-loader": "^7.0.2"<font></font>
  },<font></font>
  "devDependencies": {<font></font>
    "babel-eslint": "^8.2.1",<font></font>
    "eslint": "^4.15.0",<font></font>
    "eslint-friendly-formatter": "^3.0.0",<font></font>
    "eslint-loader": "^1.7.1",<font></font>
    "eslint-plugin-vue": "^4.0.0"<font></font>
  }<font></font>
}<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地开发看起来不错，在本地</font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也</font></font><code>start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以正常工作。</font><font style="vertical-align: inherit;">但是，当我构建Docker映像时，一切都朝南。
</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这不是Docker的问题，如果我在自己的计算机上的新目录中运行等效步骤，也是如此。</font></font></p>

<pre><code>FROM node:stretch<font></font>
<font></font>
ENV NODE_ENV=production<font></font>
ENV HOST=0.0.0.0<font></font>
EXPOSE 3000<font></font>
<font></font>
RUN npm -g i nuxt<font></font>
RUN mkdir -p /app<font></font>
ADD .nuxt /app/.nuxt<font></font>
ADD static /app/static<font></font>
WORKDIR /app<font></font>
<font></font>
CMD ["nuxt", "start"]<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是我在日志中找到的：</font></font></p>

<pre><code>2018-06-05T12:27:19.910Z nuxt:render Rendering url /<font></font>
{ Error: Cannot find module 'core-js/library/fn/promise' from '/app'<font></font>
    at Function.module.exports [as sync] (/usr/local/lib/node_modules/nuxt/node_modules/resolve/lib/sync.js:42:15)<font></font>
    at r (/usr/local/lib/node_modules/nuxt/node_modules/vue-server-renderer/build.js:8332:44)<font></font>
    at Object.&lt;anonymous&gt; (server-bundle.js:1429:18)<font></font>
    at __webpack_require__ (server-bundle.js:27:30)<font></font>
    at Object.module.exports.module.exports (server-bundle.js:105:31)<font></font>
    at __webpack_require__ (server-bundle.js:27:30)<font></font>
    at Object.&lt;anonymous&gt; (server-bundle.js:1218:138)<font></font>
    at __webpack_require__ (server-bundle.js:27:30)<font></font>
    at server-bundle.js:92:18<font></font>
    at Object.&lt;anonymous&gt; (server-bundle.js:95:10)<font></font>
    at evaluateModule (/usr/local/lib/node_modules/nuxt/node_modules/vue-server-renderer/build.js:8338:21)<font></font>
    at /usr/local/lib/node_modules/nuxt/node_modules/vue-server-renderer/build.js:8396:18<font></font>
    at new Promise (&lt;anonymous&gt;)<font></font>
    at /usr/local/lib/node_modules/nuxt/node_modules/vue-server-renderer/build.js:8388:14<font></font>
    at Object.renderToString (/usr/local/lib/node_modules/nuxt/node_modules/vue-server-renderer/build.js:8564:9)<font></font>
    at Renderer.renderRoute (/usr/local/lib/node_modules/nuxt/lib/core/renderer.js:344:41)<font></font>
  code: 'MODULE_NOT_FOUND',<font></font>
  statusCode: 500,<font></font>
  name: 'NuxtServerError' }<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然而，这一切，只要我插上消失</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的，旁边</font></font><code>.nuxt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录。</font><font style="vertical-align: inherit;">似乎某些模块未捆绑在一起。</font><font style="vertical-align: inherit;">我的</font></font><code>nuxt.config.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">档案就像</font></font></p>

<pre><code>module.exports = {<font></font>
  head: {<font></font>
    // Skipping noise...<font></font>
  },<font></font>
  modules: [<font></font>
    [ 'nuxt-fontawesome', {<font></font>
      component: 'fa',<font></font>
      imports: [<font></font>
        { set: '@fortawesome/fontawesome-free-brands' },<font></font>
      ]<font></font>
    }],<font></font>
  ],<font></font>
  loading: { color: '#3B8070' },<font></font>
  build: {<font></font>
    extend (config, { isDev, isClient }) {<font></font>
      if (isDev &amp;&amp; isClient) {<font></font>
        config.module.rules.push({<font></font>
          enforce: 'pre',<font></font>
          test: /\.(js|vue)$/,<font></font>
          loader: 'eslint-loader',<font></font>
          exclude: /(node_modules)/<font></font>
        })<font></font>
<font></font>
// *** NOTE: In practice, I'm only using FA brands here, not the others ***<font></font>
<font></font>
        config.resolve.alias['@fortawesome/fontawesome-free-brands$'] = '@fortawesome/fontawesome-free-brands/shakable.es.js'  <font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">难道我做错了什么？</font></font></p></div>
    {% endraw %}
  </div>
  <p class="winter_mark">第3489篇《nuxt start要求存在node_modules才能运行》来自Winter(https://github.com/aiyld/aiyld.github.io)的站点</p>
  <div class="discuss-wrapper">
    {% include discussTitle.html info=page %}
    {% raw %}
    <div class="discuss-list">
    <div class="discuss-item">
        <div class="discuss-parent">
          <div class="discuss-meta">
            <span class="discuss-user">猿泡芙</span>
            <span class="discuss-time">2020.03.24</span>
          </div>
          <div class="discuss-comment"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我发现Nuxt构建不会在node_modules中捆绑文件，因此如果要将所有依赖项捆绑到</font></font><code>.nuxt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则应该使用</font></font><strong><code>nuxt build --standalone</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看到这里：</font><a href="https://github.com/nuxt/nuxt.js/issues/4292" rel="nofollow noreferrer"><font style="vertical-align: inherit;">https</font></a><font style="vertical-align: inherit;"> : </font></font><a href="https://github.com/nuxt/nuxt.js/issues/4292" rel="nofollow noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//github.com/nuxt/nuxt.js/issues/4292</font></font></a> </p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">希望对你有帮助 ：）</font></font></p></div>
        </div></div>
    </div>
    {% endraw %}
  </div>
<div>
